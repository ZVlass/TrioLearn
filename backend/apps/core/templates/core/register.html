{% extends "core/base.html" %}

{% block content %}
<div class="container auth-box">
  <h2>Create your TrioLearn account</h2>

  <form method="post">
    {% csrf_token %}

    {% if form.non_field_errors %}
      <div class="alert">{{ form.non_field_errors }}</div>
    {% endif %}

    <fieldset>
      <legend>Account</legend>

      <label for="{{ form.first_name.id_for_label }}">First name</label>
      {{ form.first_name }}
      {{ form.first_name.errors }}

      <label for="{{ form.last_name.id_for_label }}">Last name</label>
      {{ form.last_name }}
      {{ form.last_name.errors }}

      <label for="{{ form.username.id_for_label }}">Username</label>
      {{ form.username }}
      {{ form.username.errors }}

      <label for="{{ form.email.id_for_label }}">Email</label>
      {{ form.email }}
      {{ form.email.errors }}

      <label for="{{ form.password.id_for_label }}">Password</label>
      {{ form.password }}
      {{ form.password.errors }}
    </fieldset>

    <fieldset>
      <legend>About you</legend>
      <div class="form-row">
        <div>
          <label for="{{ form.gender.id_for_label }}">Gender</label>
          {{ form.gender }}
          {{ form.gender.errors }}
        </div>
        <div>
          <label for="{{ form.region.id_for_label }}">Region</label>
          {{ form.region }}
          {{ form.region.errors }}
        </div>
        <div>
          <label for="{{ form.highest_education.id_for_label }}">Highest education</label>
          {{ form.highest_education }}
          {{ form.highest_education.errors }}
        </div>
        <div>
          <label for="{{ form.age_band.id_for_label }}">Age band</label>
          {{ form.age_band }}
          {{ form.age_band.errors }}
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Topics</legend>
      <p class="help">Pick up to 3 that excite you (optional).</p>
      {{ form.topic_interests }}
      {{ form.topic_interests.errors }}
    </fieldset>

    <fieldset>
      <legend>Preferred format</legend>
      <div class="help">
        {{ form.preferred_format.help_text }}
      </div>
      {{ form.preferred_format }}
      {{ form.preferred_format.errors }}
    </fieldset>

    <div class="actions">
      <button class="btn" type="submit">Create account</button>
      <a class="btn btn-secondary" href="{% url 'login' %}">I already have an account</a>
    </div>
    <p class="footer-note">By signing up you agree to our terms and privacy policy.</p>
  </form>

  <!-- Optional: small UX helper to cap topics at 3 on the client side -->
  <script>
    (function(){
      const boxes = Array.from(document.querySelectorAll("input[name='topic_interests']"));
      function sync(){
        const checked = boxes.filter(b => b.checked);
        boxes.forEach(b => { b.disabled = !b.checked && checked.length >= 3; });
      }
      boxes.forEach(b => b.addEventListener('change', sync));
      sync();
    })();
  </script>
</div>
{% endblock %}
